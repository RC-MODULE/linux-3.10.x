/*
 * Device Tree Source for RCM 1888TX018 platform
 *
 * Copyright Â© 2019 Alexey Spirkov <dev@alsp.net>
 *
 * This file is licensed under the terms of the GNU General Public
 * License version 2.  This program is licensed "as is" without
 * any warranty of any kind, whether express or implied.
 */

/include/ "1888tx018.dtsi"

/ {
	model = "rcm,1888tx018";
	compatible = "rcm,1888tx018";

	aliases {
		serial0 = &uart0;
		serial1 = &uart1;
		serial2 = &uart2;
		mmc0 = &mmc0;
	};

	plb {

		sram_nor_arbiter {
			status = "ok";
			sram-nor-mux = <1>; // 0 to route extmem wires to LSIF0, 1 - to MCIF
			// in case of LSIF0 following lines will be needed
			ext-mem-mux-mode = <0>; // 0 - SRAN_NOR, 1 - NAND GBIT_GRETH0 GBIT_GRETH1, 2 - GRETH0 GRETH1 NAND
			ce-manage = <2>; // 0
		};

		lsif0 {
			greth_gbit1: greth_gbit1@0x3C034000 {
				status = "ok";
				mac-address = [ EC 17 66 77 05 02 ];
			};
		};

		lsif1 {
			i2c0: i2c@0x3C05A000 {
				status = "ok";

				cs4384: cs4384@18 {
					compatible = "cirrus,cs4384";
					#sound-dai-cells = <1>;
					reg = <0x18>;
				};

				rtc@68 {
					compatible = "dallas,ds1338";
					reg = <0x68>;
				};

				// HDMI channel 0
				adv7513_0: adv7513@39 {
					// status = "ok";
				};

				// HDMI channel 1
				adv7513_1: adv7513@3d {
					// status = "ok";
				};
			};

			uart0: uart0@3C05D000 {
				status = "ok";
			};

			uart1: uart2@3C05E000 {
				status = "ok";
			};

			uart2: uart3@3C05F000 {
				status = "ok";
			};

			spi0: spi@0x3C061000 {
				status = "ok";

				spi_flash@0 {
					compatible = "st,m25p32", "spi-flash";
					reg = <0>;
					spi-max-frequency = <20000000>;
				};

			};

			mmc0: mmc0@0x3C064000 {
				status = "ok";
				max-frequency = <8000000>;
				cd-gpios = <&gpio1 1 0>; // card detect
			};

			gpio0: gpio0@0x3C065000 {
				status = "ok";
			};

			gpio1: gpio1@0x3C066000 {
				status = "ok";
			};

			usb_otg_hs: usb_otg_hs@0x3C06D000 {
				status = "ok";
				mode = <1>; // 1 - host, 2 - device
			};
		};

		mms {
			i2s: i2s@0x39080000 {
				status = "ok";
			};
			i2s0: i2s@0 {
				status = "ok";
			};
			i2s1: i2s@1 {
				status = "ok";
			};
			i2s2: i2s@2 {
				status = "ok";
			};
			i2s3: i2s@3 {
				status = "ok";
			};
			spdif: spdif@0x39080000 {
				status = "ok";
			};
			audio_dma: audio_dma@0x38017000 {
				status = "ok";
			};

			sound {
				// status = "ok";
				compatible = "simple-audio-card";
				simple-audio-card,name = "RCM Audio";
				#address-cells = <1>;
				#size-cells = <0>;
				#sound-dai-cells = <0>;

				simple-audio-card,dai-link@0 { // I2S0 - cs4384_0
					reg = <0>;
					format = "i2s";
					cpu {
						sound-dai = <&i2s0>;
					};
					codec {
						sound-dai = <&cs4384 0>;
					};
				};
				simple-audio-card,dai-link@1 { // I2S1 - cs4384_1
					reg = <1>;
					format = "i2s";
					cpu {
						sound-dai = <&i2s1>;
					};
					codec {
						sound-dai = <&cs4384 1>;
					};
				};
				simple-audio-card,dai-link@2 { // I2S2 - cs4384_2
					reg = <2>;
					format = "i2s";
					cpu {
						sound-dai = <&i2s2>;
					};
					codec {
						sound-dai = <&cs4384 2>;
					};
				};
				simple-audio-card,dai-link@3 { // I2S3 - cs4384_3
					reg = <3>;
					format = "i2s";
					cpu {
						sound-dai = <&i2s3>;
					};
					codec {
						sound-dai = <&cs4384 3>;
					};
				};

				simple-audio-card,dai-link@4 { // spdif
					reg = <4>;
					cpu {
						sound-dai = <&spdif>;
					};
					codec {
						sound-dai = <&spdif_out>;
					};
				};
			};

			spdif_out: spdif-out {
				#sound-dai-cells = <0>;
				compatible = "linux,spdif-dit";
			};

			// HDMI channel 0 (actually VDU index 1)
			vdu0: vdu@0x38013000 {
				// status = "ok";
			};

			// HDMI channel 1 (actually VDU index 0)
			vdu1: vdu@0x38011000 {
				// status = "ok";
			};

			vpu: vpu@0x38020000 {
				status = "ok";
			};
		};

		apb0 {

			watchdog: watchdog@0x38002000 {
				status = "ok";
			};

			thermal: thermal@0x38003000 {
				status = "ok";
			};

			cpufreq: cpufreq@0x38006000 {
				status = "ok";
				      // freq      fb pre post div
				freqs = <200000     32  1   2    0>,
				        <400000     32  1   1    0>,
				        <800000     64  1   1    0>;

			};
		};

		xhsif0 {
			pcie0: pcie@1010000000 {
				status = "ok";
			};
		};

		xhsif1 {
			pcie1: pcie@1018000000 {
				status = "ok";
			};
		};

		dspcores {
			nmc3_0_core0: nmc3_0_core0@0x39000000 {
				status = "ok";
				core-name = "K1879-nmc";
			};
			nmc3_0_core1: nmc3_0_core1@0x39020000 {
				status = "ok";
				core-name = "K1879-nmc";
			};
			nmc3_1_core0: nmc3_1_core0@0x39040000 {
				status = "ok";
				core-name = "K1879-nmc";
			};
			nmc3_1_core1: nmc3_1_core1@0x39060000 {
				status = "ok";
				core-name = "K1879-nmc";
			};
		};
	};

	thermal-zones {
		cpu-thermal {
			polling-delay-passive = <0>;
			polling-delay =  <1000>;
			thermal-sensors = <&thermal>;

			trips {
				cpu-crit {
					temperature = <100000>;
					hysteresis = <0>;
					type = "critical";
				};
			};

			cooling-maps {
			};
		};
	};

	chosen {
		stdout-path = &uart0;
	};
};

/* SRAM-NOR */
/include/ "mb115-02.dtsi"

/* Ethernet,NAND */
// /include/ "mb115-03.dtsi"

/* AV ouput */
// /include/ "mb115-04.dtsi"
